import{aN as v,dI as C,C as F,bd as i,bv as p,O as G,dJ as E,dK as K,a$ as V,E as e,c4 as u,q as X,S as f,aH as x,aX as Z,ag as k,ae as h,af as c,b3 as m,cN as J,a3 as W,L as o,N as A,M as Q,F as U,bz as Y,G as ee,H as te,T as re,I as ne,K as ae,by as se,bf as g}from"./index-Bf1X_rNU.js";import{G as oe}from"./index-biJgwu7x.js";import ie from"./Common-CsX-YJPf.js";import"./index-Bxo9sCXl.js";import"./index-OITmi6HL.js";import"./index-B10EksiI.js";import"./SettingItem-tSYhI-1L.js";import"./item_type-CV3e5W3l.js";import"./ResponsiveGrid-6aCk3tsM.js";var de=v('<svg width=1em height=1em viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-width=2><path stroke-dasharray=60 stroke-dashoffset=60 stroke-opacity=.3 d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill=freeze attributeName=stroke-dashoffset dur=1.3s values=60;0></animate></path><path stroke-dasharray=15 stroke-dashoffset=15 d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill=freeze attributeName=stroke-dashoffset dur=0.3s values=15;0></animate><animateTransform attributeName=transform dur=1.5s repeatCount=indefinite type=rotate values="0 12 12;360 12 12">'),le=v('<svg width=1em height=1em viewBox="0 0 24 24"><g stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><path fill=currentColor fill-opacity=0 stroke-dasharray=60 stroke-dashoffset=60 d="M3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12Z"><animate fill=freeze attributeName=stroke-dashoffset dur=0.5s values=60;0></animate><animate fill=freeze attributeName=fill-opacity begin=0.8s dur=0.15s values=0;0.3></animate></path><path fill=none stroke-dasharray=14 stroke-dashoffset=14 d="M8 12L11 15L16 10"><animate fill=freeze attributeName=stroke-dashoffset begin=0.6s dur=0.2s values=14;0>');function ue(r){return(()=>{var n=de();return C(n,r,!0,!0),n})()}function ce(r){return(()=>{var n=le();return C(n,r,!0,!0),n})()}const we=()=>{const r=X(),[n,b]=F(),[w,$]=i(()=>p.get("/admin/index/progress")),s=async()=>{const t=await $();se(t,a=>{b(a)})},y=setInterval(s,5e3);G(()=>clearInterval(y)),s();const[_,I]=i(E),M=async()=>{const t=await I();g(t),s()},[S,L]=i(()=>p.post("/admin/index/clear")),N=async()=>{const t=await L();g(t),s()},[B,R]=i(()=>p.post("/admin/index/stop")),z=async()=>{const t=await R();g(t),s()};let d,l;const[T,q]=i(K),D=async()=>{let t=[];d.value&&(t=d.value.split("\n"));let a=20;l.value&&(a=parseInt(l.value));const j=await q(t,a);g(j),s()},{isOpen:H,onOpen:P,onClose:O}=V();return e(k,{spacing:"$2",w:"$full",alignItems:"start",get children(){return[e(u,{get children(){return r("manage.sidemenu.settings")}}),e(ie,{get group(){return oe.INDEX}}),e(u,{get children(){return r("indexes.current")}}),e(f,{get when(){return n()},get children(){return e(x,{spacing:"$2",w:"fit-content",shadow:"$md",rounded:"$lg",get bg(){return W("","$neutral3")()},get children(){return[e(Z,{boxSize:"$28",color:"$accent9",p:"$2",get as(){var t;return(t=n())!=null&&t.is_done?ce:ue}}),e(k,{spacing:"$2",flex:"1",alignItems:"start",mr:"$2",get children(){return[e(h,{get children(){return[c(()=>r("indexes.obj_count")),":",e(m,{colorScheme:"info",ml:"$2",get children(){var t;return(t=n())==null?void 0:t.obj_count}})]}}),e(h,{get children(){return[c(()=>r("indexes.last_done_time")),":",e(m,{colorScheme:"accent",ml:"$2",get children(){return c(()=>!!n().last_done_time)()?J(n().last_done_time):r("indexes.unknown")}})]}}),e(f,{get when(){var t;return(t=n())==null?void 0:t.error},get children(){return e(h,{css:{wordBreak:"break-all"},get children(){return[c(()=>r("indexes.error")),":",e(m,{colorScheme:"danger",ml:"$2",get children(){return n().error}})]}})}})]}})]}})}}),e(x,{spacing:"$2",get children(){return[e(o,{colorScheme:"accent",onClick:[s,void 0],get loading(){return w()},get children(){return r("global.refresh")}}),e(o,{colorScheme:"danger",onClick:[N,void 0],get loading(){return S()},get children(){return r("indexes.clear")}}),e(o,{colorScheme:"warning",onClick:[z,void 0],get loading(){return B()},get children(){return r("indexes.stop")}}),e(o,{onClick:[M,void 0],get loading(){return _()},get children(){var t;return r("indexes.".concat((t=n())!=null&&t.is_done?"rebuild":"build"))}})]}}),e(o,{onClick:P,get children(){return r("indexes.update")}}),e(A,{get opened(){return H()},onClose:O,get children(){return[e(Q,{}),e(U,{get children(){return[e(Y,{}),e(ee,{get children(){return r("indexes.update")}}),e(te,{get children(){return[e(u,{get children(){return r("indexes.paths_to_update")}}),e(re,{ref(t){var a=d;typeof a=="function"?a(t):d=t}}),e(u,{get children(){return r("indexes.max_depth")}}),e(ne,{value:20,type:"number",ref(t){var a=l;typeof a=="function"?a(t):l=t}})]}}),e(ae,{get children(){return e(o,{onClick:[D,void 0],get loading(){return T()},get children(){return r("indexes.update")}})}})]}})]}})]}})};export{we as default};
