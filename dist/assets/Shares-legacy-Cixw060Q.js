System.register(["./index-legacy-yN-z1lAK.js","./index-legacy-DRrLOnvb.js","./share-legacy-BuKfSElJ.js","./DeletePopover-legacy-EFpSEKrM.js"],function(e,r){"use strict";var t,n,s,a,i,c,l,h,d,g,u,o,m,f,b,p,w,x,$,_,y,k,S,v,C,D,j,W,I,L,O,Y,q;return{setters:[e=>{t=e.bY,n=e.E,s=e.dg,a=e.S,i=e.a6,c=e.a7,l=e.ac,h=e.q,d=e.aJ,g=e.L,u=e.b$,o=e.dd,m=e.b3,f=e.W,b=e.k,p=e.bd,w=e.bv,x=e.bf,$=e.by,_=e.x,y=e.C,k=e.aZ,S=e.aY,v=e.ao,C=e.db,D=e.dc,j=e.U,W=e.de,I=e.df,L=e.ai},e=>{O=e.f},e=>{Y=e.m},e=>{q=e.D}],execute:function(){function r(e){const r=h(),{to:t}=b(),[s,a]=p(()=>w.post(`/share/delete?id=${e.share.id}`)),[i,c]=p(()=>w.post(`/share/${e.share.disabled?"enable":"disable"}?id=${e.share.id}`));return[n(g,{get disabled(){return!e.canShare},onClick:()=>{t(`/@manage/shares/edit/${e.share.id}`)},get children(){return r("global.edit")}}),n(g,{get loading(){return i()},get colorScheme(){return e.share.disabled?"success":"warning"},onClick:async()=>{const r=await c();x(r,()=>{e.refresh()})},get children(){return r("global."+(e.share.disabled?"enable":"disable"))}}),n(q,{get name(){return e.share.id},get loading(){return s()},onClick:async()=>{const t=await a();$(t,()=>{_.success(r("global.delete_success")),e.refresh()})}})]}const A=e=>{if(e.role<0)return null;const r=["info","neutral","accent"];return n(m,{get colorScheme(){return r[e.role]},css:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},get children(){return e.name}})};function E(e){const m=h(),{copy:b}=t();return n(o,{get children(){return[n(s,{get children(){return(()=>{if(0===e.share.files.length)return"";let r=e.share.files[0];return e.share.files.length>1&&(r+=m("shares.files_etc",{more:e.share.files.length-1})),r})()}}),n(s,{get children(){return e.share.id}}),n(a,{get when(){return i.is_admin(c())},get children(){return n(s,{get children(){return n(A,{get name(){return e.share.creator},get role(){return e.share.creator_role}})}})}}),n(s,{get children(){return l(()=>!!e.share.expires)()?new Date(e.share.expires).toLocaleString():""}}),n(s,{get children(){return e.share.max_accessed>0?`${e.share.accessed} / ${e.share.max_accessed}`:`${e.share.accessed}`}}),n(s,{get children(){return m("shares.status_list."+(e.share.disabled?"disabled":e.share.max_accessed>0&&e.share.accessed>=e.share.max_accessed||0===e.share.files.length||e.share.expires&&new Date(e.share.expires)<new Date?"invalid":e.share.creator!==c().username||e.canShare?"work":"denied"))}}),n(s,{get children(){return e.share.remark}}),n(s,{get children(){return n(d,{spacing:"$2",get children(){return[n(g,{colorScheme:"primary",onClick:()=>{const r=Y(e.share,{site_title:f("site_title")}),t=u(f("share_summary_content"),r);b(t)},get children(){return m("shares.copy_msg")}}),n(r,e)]}})}})]}})}e("default",()=>{const e=h();O("manage.sidemenu.shares");const{to:r}=b(),[t,s]=p(()=>w.get("/share/list")),[u,m]=y([]),f=async()=>{const e=await s();$(e,e=>m(e.content))},x=i.can(c(),k.findIndex(e=>"share"===e));return f(),n(L,{spacing:"$3",alignItems:"start",w:"$full",get children(){return[n(d,{spacing:"$2",gap:"$2",w:"$full",wrap:{"@initial":"wrap","@md":"unset"},get children(){return[n(g,{colorScheme:"accent",get loading(){return t()},onClick:f,get children(){return e("global.refresh")}}),n(a,{when:!x,get fallback(){return n(g,{onClick:()=>r("/@manage/shares/add"),get children(){return e("global.add")}})},get children(){return n(S,{withArrow:!0,get label(){return e("shares.no_permission_tip")},placement:"right",get children(){return n(g,{disabled:!0,get children(){return[" ",l(()=>e("global.add"))," "]}})}})}})]}}),n(v,{w:"$full",overflowX:"auto",get children(){return n(C,{highlightOnHover:!0,dense:!0,get children(){return[n(D,{get children(){return n(o,{get children(){return[n(j,{each:["files","id"],children:r=>n(W,{css:{minWidth:"90px"},get children(){return e(`shares.${r}`)}})}),n(a,{get when(){return i.is_admin(c())},get children(){return n(W,{css:{minWidth:"100px"},get children(){return e("shares.creator")}})}}),n(j,{each:["expires","accessed","status","remark"],children:r=>n(W,{css:{minWidth:"90px"},get children(){return e(`shares.${r}`)}})}),n(W,{get children(){return e("global.operations")}})]}})}}),n(I,{get children(){return n(j,{get each(){return u()},children:e=>n(E,{share:e,refresh:f,canShare:x})})}})]}})}})]}})})}}});
