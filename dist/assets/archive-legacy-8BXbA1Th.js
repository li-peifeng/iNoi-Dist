System.register(["./index-legacy-lNyWm5Cj.js","./List-legacy-CHh6KwUd.js","./index-legacy-Dr2tzuS6.js","./Password-legacy-CSLt8gaX.js","./helper-legacy-D7PNrdVN.js","./icon-legacy-DAemAWHX.js","./style-legacy-B-NHJKXd.js","./obj-legacy-BKgCPAKc.js","./Layout-legacy-CBXDujqj.js","./index-legacy-CfVGfNbS.js","./FolderTree-legacy-CBMQ2Xq5.js","./index-legacy-1jSvJ3Bt.js","./index-legacy-BAYHPaeU.js","./share-legacy-BbqdEjcu.js","./icons-legacy-DZCLP2T0.js","./index-legacy-CQ5ifZXZ.js"],function(e,r){"use strict";var t,n,l,a,i,c,o,s,d,u,g,h,p,m,w,b,f,y,j,x,$,k,_,v,C,P,S,z,M,A,L,q,B,E,I,O,X,H,J,N,R,T,U,Y,D,F,K,Q,V,Z,G,W;return{setters:[e=>{t=e.k,n=e.bd,l=e.er,a=e.es,i=e.P,c=e.C,o=e.D,s=e.E,d=e.a2,u=e.X,g=e.Y,h=e.U,p=e.a1,m=e.a6,w=e.a7,b=e.a8,f=e.S,y=e.ae,j=e.q,x=e.an,$=e.ag,k=e.V,_=e.af,v=e.d3,C=e.bX,P=e.aH,S=e.aX,z=e.aB,M=e.r,A=e.cB,L=e.ds,q=e.a0,B=e.au,E=e.et,I=e.bY,O=e.cx,X=e.aM,H=e.aZ,J=e.aK,N=e.aL,R=e._,T=e.aT},e=>{U=e.L,Y=e.c},e=>{D=e.b,F=e.e},e=>{K=e.default},e=>{Q=e.u},e=>{V=e.g},e=>{Z=e.b,G=e.x,W=e.w},null,null,null,null,null,null,null,null,null],execute:function(){const r=e=>{window.open(e,"_blank")},ee=e=>{const{show:t}=Z({id:2}),{isMouseSupported:n}=Q(),l=()=>M.list_item_filename_overflow;return s(B.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return s(P,{class:"list-item viselect-item",get"data-index"(){return e.index},w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",get _hover(){return{transform:"scale(1.01)",bgColor:q()}},get cursor(){return n()?"default":"pointer"},"on:click":t=>{e.obj.is_dir?e.jumpCallback():e.url&&r(e.url)},onContextMenu:r=>{t(r,{props:e})},get children(){return[s(P,{class:"name-box",spacing:"$1",get w(){return Y[0].w},get children(){return[s(S,{class:"icon",boxSize:"$6",get color(){return z()},get as(){return V(e.obj)},mr:"$1"}),s(y,{class:"name",get css(){return{wordBreak:"break-all",whiteSpace:"multi_line"===l()?"unset":"nowrap","overflow-x":"scrollable"===l()?"auto":"hidden",textOverflow:"ellipsis"===l()?"ellipsis":"unset","scrollbar-width":"none","&::-webkit-scrollbar":{display:"none"}}},get title(){return e.obj.name},get children(){return e.obj.name}})]}}),s(y,{class:"size",get w(){return Y[1].w},get textAlign(){return Y[1].textAlign},get children(){return A(e.obj.size)}}),s(y,{class:"modified",display:{"@initial":"none","@md":"inline"},get w(){return Y[2].w},get textAlign(){return Y[2].textAlign},get children(){return L(e.obj.modified)}})]}})}})},re={extract:{icon:F,color:"$success9"},copy_link:{icon:D,color:"$info9"},download:{icon:T,color:"$primary9"}},te=()=>{const{copy:e}=I(),{colorMode:n}=O(),{isShare:l}=t();return s(W,{id:2,animation:"scale",get theme(){return"dark"!==n()?"light":"dark"},style:"z-index: var(--hope-zIndices-popover)",get children(){return[s(G,{hidden:({props:e})=>e.obj.is_dir,onClick:({props:e})=>{r(e.url)},get children(){return s(ne,{name:"download"})}}),s(G,{hidden:({props:e})=>e.obj.is_dir,onClick:({props:r})=>{e(r.url)},get children(){return s(ne,{name:"copy_link"})}}),s(G,{hidden:()=>{const e=H.findIndex(e=>"decompress"===e);return!l()&&!J.can(N(),e)},onClick:({props:e})=>{X.emit("extract",JSON.stringify({inner:e.innerPath,pass:e.pass}))},get children(){return s(ne,{name:"extract"})}})]}})},ne=e=>{const r=j();return s(P,{spacing:"$2",get children(){return[s(S,{get p(){return re[e.name].p?"$1":void 0},get as(){return re[e.name].icon},boxSize:"$7",get color(){return re[e.name].color}}),s(y,{get children(){return r(`home.toolbar.${e.name}`)}})]}})};e("default",()=>{const e=j(),{pathname:r}=t(),[P,S]=n(l),[z,M]=n(a),A=i(()=>P()||z());let L="",q="",B="",I=null;const[O,X]=c(""),[H,J]=c(!1),[N,T]=c(!1),[Y,D]=c(""),[F,Q]=c([]),[V,Z]=c(),[G,W]=c(!1),[re,ne]=c(""),le=function(){let e=!1,r=[];return{acquire:()=>new Promise(t=>{e?r.push(t):(e=!0,t())}),release:()=>{r.length>0?r.shift()():e=!1}}}(),ae=e=>{let r={};return e.forEach(e=>{r[e.name]={...e,children:e.children?ae(e.children):null}}),r},ie=e=>200!==e.code&&(202===e.code?C(()=>{""!==L&&J(!0),T(!0),X("")}):X(e.message),!0),ce=async e=>{if(await le.acquire(),N()&&""===L)return le.release(),[];if(""===q){const e=await S(r(),R(),L);if(ie(e))return le.release(),[];if(null!==e.data.content&&(I=ae(e.data.content)),q=e.data.raw_url,B=e.data.sign,D(e.data.comment),void 0!==e.data.sort){let r;""!==e.data.sort.order_by&&(r=e.data.sort.order_by);let t="desc"===e.data.sort.order_direction,n=e.data.sort.extract_folder;C(()=>{Z(r),W(t),ne(n)})}if(e.data.encrypted&&""===L)return C(()=>{T(!0),X("")}),le.release(),[]}if(null===I){const e=await M(r(),R(),L,"/");if(ie(e))return le.release(),[];I=ae(e.data.content)}let t=I;for(let n=0;n<e.length;n++){if(null===t[e[n]].children){const l=await M(r(),R(),L,"/"+e.slice(0,n+1).join("/"));if(ie(l))return le.release(),[];t[e[n]].children=ae(l.data.content)}t=t[e[n]].children}return C(()=>{T(!1),J(!1),X("")}),le.release(),Object.values(t)},[oe,se]=c([]);o(()=>{ce(F()).then(e=>se(e))});const de=()=>{ce(F()).then(e=>se(e))};de();const ue=(e,r)=>{C(()=>{ne(""),Z(e),void 0!==r&&W(r)})};return s($,{spacing:"$2",w:"$full",get children(){return[s(d,{pl:"$2",pr:"$2",w:"$full",get children(){return[s(u,{get children(){return s(g,{get currentPage(){return 0===F().length},"on:click":()=>Q([]),children:"."})}}),s(h,{get each(){return F()},children:(e,r)=>s(u,{get children(){return[s(p,{}),s(g,{get currentPage(){return F().length===r()+1},"on:click":()=>Q(F().slice(0,r()+1)),children:e})]}})})]}}),s(m,{get children(){return[s(w,{get when(){return""!==O()},get children(){return s(b,{get msg(){return O()},disableColor:!0})}}),s(w,{get when(){return N()},get children(){return s(K,{get title(){return e("home.toolbar.archive.input_password")},password:()=>L,setPassword:e=>L=e,enterCallback:()=>de(),get children(){return s(f,{get when(){return H()},get children(){return s(y,{color:"$danger9",get children(){return e("home.toolbar.archive.incorrect_password")}})}})}})}}),s(w,{get when(){return _(()=>!N())()&&""===O()},get children(){return s(x,{get loading(){return A()},get children(){return s($,{class:"list",w:"$full",spacing:"$1",get children(){return[s(U,{sortCallback:ue,disableCheckbox:!0}),s(h,{get each(){return(()=>{let e=oe();V()&&(e=e.sort((e,r)=>(G()?-1:1)*E(e[V()],r[V()])));let r=re();if(""!==r){let t=[],n=[];e.forEach(e=>(e.is_dir?t:n).push(e)),e="front"===r?t.concat(n):n.concat(t)}return e})()},children:(e,r)=>{let t,n=(F().length>0?"/"+F().join("/"):"")+"/"+e.name;if(!e.is_dir){const e=q.includes("?");t=q+`${e?"&":"?"}inner=${k(n,!0)}`,""!==L&&(t+=`&pass=${encodeURIComponent(L)}`),""!==B&&(t+=`&sign=${B}`)}return s(ee,{obj:e,get index(){return r()},jumpCallback:()=>Q(F().concat(e.name)),innerPath:n,url:t,pass:L})}}),s(te,{})]}})}})}})]}}),s(f,{get when(){return""!==Y()},get children(){return[s(v,{}),s(y,{w:"$full",pl:"$1",pr:"$1",get children(){return Y()}})]}})]}})})}}});
