import{E as t,bI as R,q as $,a6 as V,a7 as h,aH as q,I as y,S as s,aw as B,af as w,bU as H,T as M,bJ as j,b_ as z,aO as A,bV as G,k as J,bd as _,bv as T,bZ as P,C as o,c4 as U,L as X,by as k,x as Z,an as D,bX as K}from"./index-Bf1X_rNU.js";import{r as Q}from"./share-BYkYhSDT.js";import{T as r}from"./item_type-CV3e5W3l.js";import{R as W}from"./ResponsiveGrid-6aCk3tsM.js";import{i as Y}from"./index-OITmi6HL.js";const l=e=>{const m=$();return t(G,{w:"$full",display:"flex",flexDirection:"column",get required(){return e.required},get children(){return[t(R,{get for(){return e.name},display:"flex",alignItems:"center",get children(){var a;return m((a=e.full_name_path)!=null?a:"shares.".concat(e.name))}}),t(V,{get fallback(){return t(A,{get children(){return m("settings.unknown_type")}})},get children(){return[t(h,{get when(){return e.type===r.String},get children(){return t(q,{w:"$full",spacing:"$2",get children(){return[t(y,{get id(){return e.name},type:"text",get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===r.String?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,a.currentTarget.value)}:void 0}}),t(s,{get when(){return w(()=>e.type===r.String)()&&e.random},get children(){return t(B,{colorScheme:"neutral","aria-label":"random",get icon(){return t(Y,{})},get onClick(){return e.type===r.String?()=>{var a;return(a=e.onChange)==null?void 0:a.call(e,e.random())}:void 0}})}})]}})}}),t(h,{get when(){return e.type===r.Number},get children(){return t(y,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onInput(){return e.type===r.Number?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,parseInt(a.currentTarget.value))}:void 0}})}}),t(h,{get when(){return e.type===r.Float},get children(){return t(y,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onInput(){return e.type===r.Float?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,parseFloat(a.currentTarget.value))}:void 0}})}}),t(h,{get when(){return e.type===r.Bool},get children(){return t(H,{get id(){return e.name},get readOnly(){return e.readonly},get defaultChecked(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===r.Bool?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,a.currentTarget.checked)}:void 0}})}}),t(h,{get when(){return e.type===r.Text},get children(){return t(M,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===r.Text?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,a.currentTarget.value)}:void 0}})}}),t(h,{get when(){return e.type===r.Select},get children(){return t(j,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===r.Select?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,a)}:void 0},get children(){return t(z,{get readonly(){return e.readonly},get searchable(){return w(()=>e.type===r.Select)()&&e.searchable},get options(){return e.options.split(",").map(a=>{var u;return{key:a,label:m(((u=e.options_prefix)!=null?u:"shares.".concat(e.name,"s"))+".".concat(a))}})}})}})}})]}})]}})},ie=()=>{const e=$(),{params:m,back:a,to:u}=J(),{id:g}=m,[I,O]=_(()=>T.get("/share/get?id=".concat(g)),!0),[d,i]=P({}),[F,b]=o(""),[f,S]=o(!1),[E,x]=o(""),[C,v]=o(!0);g&&(async()=>{const n=await O();k(n,c=>{K(()=>{i(c),b(c.files.join("\n")),c.expires&&x(new Date(c.expires).toLocaleString()),S(!0)})})})();const[L,N]=_(()=>T.post("/share/".concat(g?"update":"create"),d));return t(D,{get loading(){return g?I():!1},get children(){return[t(U,{mb:"$2",get children(){return e("global.".concat(g?"edit":"add"))}}),t(W,{get children(){return[t(s,{when:g,get children(){return t(l,{name:"id",get type(){return r.String},value:g,valid:!0,readonly:!0})}}),t(l,{name:"files",get type(){return r.Text},get value(){return F()},get valid(){return f()},required:!0,onChange:n=>{b(n),S(n.length>0),i("files",n.split("\n"))}}),t(l,{name:"remark",get type(){return r.Text},get value(){return d.remark},valid:!0,onChange:n=>{i("remark",n)}}),t(l,{name:"extract_folder",get type(){return r.Select},get value(){return d.extract_folder},valid:!0,options:"front,back",onChange:n=>{i("extract_folder",n)}}),t(l,{name:"order_by",get type(){return r.Select},get value(){return d.order_by},valid:!0,options:"name,size,modified",onChange:n=>{i("order_by",n)}}),t(l,{name:"order_direction",get type(){return r.Select},get value(){return d.order_direction},valid:!0,options:"asc,desc",onChange:n=>{i("order_direction",n)}}),t(l,{name:"pwd",get type(){return r.String},get value(){return d.pwd},valid:!0,onChange:n=>{i("pwd",n)},random:Q}),t(l,{name:"max_accessed",get type(){return r.Number},get value(){return d.max_accessed},valid:!0,onChange:n=>{i("max_accessed",n)}}),t(s,{when:g,get children(){return t(l,{name:"accessed",get type(){return r.Number},get value(){return d.accessed},valid:!0,onChange:n=>{i({...d,accessed:n})}})}}),t(l,{name:"expires",get type(){return r.String},get value(){return E()},get valid(){return C()},onChange:n=>{if(x(n),n===""){v(!0),i("expires",null);return}const c=new Date(n);isNaN(c.getTime())?v(!1):(v(!0),i("expires",c.toISOString()))}}),t(l,{name:"readme",get type(){return r.Text},get value(){return d.readme},valid:!0,onChange:n=>{i("readme",n)}}),t(l,{name:"header",get type(){return r.Text},get value(){return d.header},valid:!0,onChange:n=>{i("header",n)}})]}}),t(X,{mt:"$2",get disabled(){return!C()||!f()},get loading(){return L()},onClick:async()=>{const n=await N();k(n,()=>{Z.success(e("global.save_success")),a()},(c,ee)=>{n.data.id&&u("/@manage/shares/edit/".concat(n.data.id))})},get children(){return e("global.".concat(g?"save":"add"))}})]}})};export{ie as default};
