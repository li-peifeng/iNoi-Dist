System.register(["./index-legacy-CBHUkAr_.js","./icon-legacy-BjTY9KWg.js","./video_box-legacy-BTjK3BTM.js","./hls-legacy-6LKyBC1D.js","./index-legacy-DpMQFZhh.js","./Layout-legacy-BiomREf1.js","./index-legacy-DXsp5Fq1.js","./FolderTree-legacy-B_t0JM0n.js","./index-legacy-DsFP-jjP.js","./index-legacy-CnLPjP07.js","./index-legacy-DHZAua88.js"],function(e,t){"use strict";var i,n,l,s,a,o,r,u,c,d,h,p,g,m,y,f,w,b,v,_,k,x,j,S,O,L,C,F,z,I,T,A,E,q,N,P;return{setters:[e=>{i=e.k,n=e.aj,l=e.d_,s=e.a9,a=e.d$,o=e.aB,r=e.cS,u=e.aN,c=e.bt,d=e.a$,h=e.dj,p=e.dl,g=e.bc,m=e.bu,y=e._,f=e.at,w=e.O,b=e.C,v=e.E,_=e.al,k=e.S,x=e.aO,j=e.ap,S=e.bx,O=e.x,L=e.A,C=e.e0},e=>{F=e.O,z=e.A},e=>{I=e.A,T=e.V,A=e.a},e=>{E=e.a,q=e.b,N=e.H},e=>{P=e.p},null,null,null,null,null,null],execute:function(){var t=u("<span style=max-width:200px;text-overflow:ellipsis;word-break:break-all;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:12px>");e("default",()=>{const{pathname:e,searchParams:u}=i(),{proxyLink:$}=n(),V=l();let W=s.objs.filter(e=>e.type===F.VIDEO);0===W.length&&(W=[s.obj]);let B,D={id:e(),container:"#video-player",title:s.obj.name,volume:.5,autoplay:j("video_autoplay"),autoSize:!1,autoMini:!0,controls:[],loop:!1,flip:!0,playbackRate:!0,aspectRatio:!0,setting:!0,hotkey:!0,pip:!0,mutex:!0,fullscreen:!0,fullscreenWeb:!1,subtitleOffset:!0,miniProgressBar:!1,playsInline:!0,theme:o(),quality:[],plugins:[I],whitelist:[],screenshot:!0,settings:[],moreVideoAttr:{"webkit-playsinline":!0,playsInline:!0,crossOrigin:"anonymous"},type:"m3u8",customType:{m3u8:function(e,t){const i=new N;i.loadSource(t),i.attachMedia(e),e.src||(e.src=t)}},lang:["en","zh-cn","zh-tw"].includes(a().toLowerCase())?a().toLowerCase():"en",lock:!0,fastForward:!0,autoPlayback:!0,autoOrientation:!0,airplay:!0};const H=s.related.filter(e=>{for(const t of[".srt",".ass",".vtt"])if(e.name.endsWith(t))return!0;return!1}),M=s.related.find(e=>{for(const t of[".xml"])if(e.name.endsWith(t))return!0;return!1});if(0!=H.length){let e=function(e){"ass"==(i?"ass":"webvtt")?(B.subtitle.show=!1,B.emit("artplayer-plugin-ass:visible",e)):(B.subtitle.show=e,B.emit("artplayer-plugin-ass:visible",!1))},i=!1;const n=H[0];"ass"===r(n.name).toLowerCase()?(i=!0,D.plugins?.push(E({subUrl:$(n,!0)}))):D.subtitle={url:$(n,!0),type:r(n.name)};const l=[{id:"setting_subtitle_display",html:"Display",tooltip:"Show",switch:!0,onSwitch:function(t){t.tooltip=t.switch?"Hide":"Show",e(!t.switch);const i=D.settings?.find(e=>"setting_subtitle"===e.id);return i&&(i.tooltip=t.tooltip),!t.switch}}];H.forEach((e,i)=>{var n;l.push({default:0===i,html:(n=t(),c(n,"overflow","hidden"),c(n,"display","-webkit-box"),d(n,()=>e.name),h(()=>p(n,"title",e.name)),n),name:e.name,url:$(e,!0)})}),D.settings?.push({id:"setting_subtitle",html:"Subtitle",tooltip:"Show",icon:z({size:24}),selector:l,onSelect:function(t){"ass"===r(t.name).toLowerCase()?(i=!0,this.emit("artplayer-plugin-ass:switch",t.url),e(!0)):(i=!1,this.subtitle.switch(t.url,{name:t.name}),this.once("subtitleLoad",e.bind(this,!0)));const n=l.find(e=>"setting_subtitle_display"===e.id);return n&&!n.switch&&n.$html?.click?.(),n?.tooltip}})}M&&D.plugins?.push(q({danmuku:$(M,!0),speed:5,opacity:1,fontSize:25,color:"#FFFFFF",mode:0,margin:[0,"0%"],antiOverlap:!1,synchronousPlayback:!1,lockTime:5,maxLength:100,theme:"dark"}));const[R,U]=g(()=>m.post("/fs/other",{path:e(),password:y(),method:"video_preview"}));let K,G;async function J(){const e=await U();S(e,async e=>{const t=e.video_preview_play_info.live_transcoding_task_list.filter(e=>e.url);if(0===t.length)return void O.error("No transcoding video found");const i=t.map((e,i)=>({html:e.template_id,url:e.url,default:i===t.length-1}));D.quality=i,B.quality=i,G=B.currentTime;let n=B.playing;await B.switchUrl(i[i.length-1].url),n||B.pause(),setTimeout(()=>{B.seek=G},1e3)})}f(async()=>{const e=await U();Z(200!==e.code),S(e,e=>{const t=e.video_preview_play_info.live_transcoding_task_list.filter(e=>e.url);if(0===t.length)return void O.error("No transcoding video found");let i;switch(D.url=t[t.length-1].url,D.quality=t.map((e,i)=>({html:e.template_id,url:e.url,default:i===t.length-1})),B=new A(D),u.auto_fullscreen){case"true":i=!0;case"false":i=!1;default:i=!1}B.on("ready",()=>{B.fullscreen=i}),B.on("video:ended",()=>{Q()&&(()=>{const e=W.findIndex(e=>e.name===s.obj.name);e<W.length-1&&V(L(C(location.pathname),W[e+1].name)+"?auto_fullscreen="+B.fullscreen)})()}),K=window.setInterval(J,84e4)}),B.on("error",()=>{B.video.crossOrigin&&(console.log("Error detected. Trying to remove Cross-Origin attribute. Screenshot may not be available."),B.video.crossOrigin=null)})}),w(()=>{B?.destroy(),window.clearInterval(K)});const[Q,X]=b(),[Y,Z]=b(!1);return v(T,{onAutoNextChange:X,get children(){return[v(_,{w:"$full",h:"60vh",id:"video-player"}),v(k,{get when(){return Y()},get children(){return v(x,{w:"100%",h:"60vh",bgColor:"black",get children(){return v(P,{size:"4rem"})}})}})]}})})}}});
