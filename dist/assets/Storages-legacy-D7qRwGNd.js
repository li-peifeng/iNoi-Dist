System.register(["./index-legacy-BDeHuhEG.js","./index-legacy-BSmJRROv.js","./DeletePopover-legacy-5CcsRhr3.js"],function(e,r){"use strict";var t,n,a,s,l,o,g,i,d,c,u,h,m,b,f,$,p,_,v,w,k,y,x,C,S,B,D,L,P,T,j,E,F,H,M,q,G,O,U,W,X,z,A,I,J,K,N;return{setters:[e=>{t=e.E,n=e.aH,a=e.ae,s=e.b3,l=e.q,o=e.S,g=e.af,i=e.am,d=e.aB,c=e.a3,u=e.ag,h=e.dF,m=e.dC,b=e.k,f=e.bd,$=e.bv,p=e.L,_=e.bf,v=e.by,w=e.x,k=e.cC,y=e.cD,x=e.dG,C=e.C,S=e.P,B=e.cv,D=e.bJ,L=e.bL,P=e.bM,T=e.bN,j=e.bO,E=e.bP,F=e.bQ,H=e.U,M=e.bR,q=e.bS,G=e.bT,O=e.bU,U=e.a6,W=e.a7,X=e.dq,z=e.dA,A=e.dB,I=e.dD,J=e.dE},e=>{K=e.f},e=>{N=e.D}],execute:function(){const r=e=>{let r=e.total_space,t=r-e.free_space;const n=["B","K","M","G","T","P","E"],a=1024;let s=0;for(;s<n.length-1&&(t>=a||r>=a);)t/=a,r/=a,s++;return`${t.toFixed(2)} / ${r.toFixed(2)} ${n[s]}`},Q=e=>e.free_space/e.total_space<.1;function R(e){const r=l(),{to:n}=b(),[a,s]=f(()=>$.post(`/admin/storage/delete?id=${e.storage.id}`)),[o,g]=f(()=>$.post(`/admin/storage/${e.storage.disabled?"enable":"disable"}?id=${e.storage.id}`));return[t(p,{onClick:()=>{n(`/@manage/storages/edit/${e.storage.id}`)},get children(){return r("global.edit")}}),t(p,{get loading(){return o()},get colorScheme(){return e.storage.disabled?"success":"warning"},onClick:async()=>{const r=await g();_(r,()=>{e.refresh()})},get children(){return r("global."+(e.storage.disabled?"enable":"disable"))}}),t(N,{get name(){return e.storage.mount_path},get loading(){return a()},onClick:async()=>{const t=await s();v(t,()=>{w.success(r("global.delete_success")),e.refresh()})}})]}function V(e){return t(o,{get when(){return e.details},get children(){return t(k,{class:"disk-usage-percentage",trackColor:"$info3",rounded:"$full",size:"md",get value(){return((r=e.details).total_space-r.free_space)/r.total_space*100;var r},get children(){return[t(y,{get color(){return Q(e.details)?"$danger6":"$info6"},rounded:"$md"}),t(x,{class:"disk-usage-text",get children(){return r(e.details)}})]}})}})}function Y(e){const h=l();return t(u,{w:"$full",spacing:"$2",rounded:"$lg",border:"1px solid $neutral7",get background(){return c("$neutral2","$neutral3")()},p:"$3",get _hover(){return{border:`1px solid ${d()}`}},get children(){return[t(n,{spacing:"$2",get children(){return[t(a,{fontWeight:"$medium",css:{wordBreak:"break-all"},get children(){return e.storage.mount_path}}),t(s,{colorScheme:"info",get children(){return h(`drivers.drivers.${e.storage.driver}`)}}),t(o,{get when(){return e.storage.mount_details},get children(){return t(s,{get colorScheme(){return Q(e.storage.mount_details)?"danger":"success"},get children(){return r(e.storage.mount_details)}})}})]}}),t(n,{get children(){return[t(a,{get children(){return[g(()=>h("storages.common.status")),":Â "]}}),t(i,{css:{wordBreak:"break-all"},overflowX:"auto",get innerHTML(){return h(`storages.table_fields.status.${e.storage.status}`,void 0,e.storage.status)}})]}}),t(a,{css:{wordBreak:"break-all"},get children(){return e.storage.remark}}),t(n,{spacing:"$2",get children(){return t(R,e)}})]}})}function Z(e){const r=l();return t(m,{get children(){return[t(h,{get children(){return e.storage.mount_path}}),t(h,{get children(){return r(`drivers.drivers.${e.storage.driver}`)}}),t(h,{get children(){return e.storage.order}}),t(h,{get children(){return t(V,{get details(){return e.storage.mount_details}})}}),t(h,{get children(){return r(`storages.table_fields.status.${e.storage.status}`,void 0,e.storage.status)}}),t(h,{get children(){return e.storage.remark}}),t(h,{get children(){return t(n,{spacing:"$2",get children(){return t(R,e)}})}})]}})}e("default",()=>{const e=l();K("manage.sidemenu.storages");const{to:r}=b(),[a,s]=f(()=>$.get("/admin/storage/list")),[g,d]=C([]),c=async()=>{const e=await s();v(e,e=>d(e.content))},[h,_]=C([]),[k,y]=C([]);(async()=>{const e=await $.get("/admin/driver/names");v(e,e=>_(e))})(),c();const x=async()=>{const r=await $.post("/admin/storage/load_all");v(r,()=>{w.success(e("storages.other.start_load_success"))})},N=S(()=>g().filter(e=>0===k().length||k().includes(e.driver))),[Q,R]=B("storages-layout","grid");return t(u,{spacing:"$3",alignItems:"start",w:"$full",get children(){return[t(n,{spacing:"$2",w:"$full",wrap:"nowrap",get children(){return[t(p,{colorScheme:"accent",get loading(){return a()},onClick:c,get children(){return e("global.refresh")}}),t(p,{onClick:()=>{r("/@manage/storages/add")},get children(){return e("global.add")}}),t(p,{colorScheme:"warning",get loading(){return a()},onClick:x,get children(){return e("storages.other.load_all")}}),t(o,{get when(){return h().length>0},get children(){return t(D,{multiple:!0,get value(){return k()},onChange:y,get children(){return[t(L,{get children(){return[t(P,{get children(){return e("storages.other.filter_by_driver")}}),t(T,{}),t(j,{})]}}),t(E,{get children(){return t(F,{get children(){return t(H,{get each(){return h()},children:r=>t(M,{value:r,get children(){return[t(q,{get children(){return e(`drivers.drivers.${r}`)}}),t(G,{})]}})})}})}})]}})}}),t(O,{flexShrink:0,get checked(){return"table"===Q()},onChange:e=>{R(e.currentTarget.checked?"table":"grid")},get children(){return e("storages.other.table_layout")}})]}}),t(U,{get children(){return[t(W,{get when(){return"grid"===Q()},get children(){return t(X,{w:"$full",gap:"$2_5",templateColumns:{"@initial":"1fr","@lg":"repeat(auto-fill, minmax(324px, 1fr))"},get children(){return t(H,{get each(){return N()},children:e=>t(Y,{storage:e,refresh:c})})}})}}),t(W,{get when(){return"table"===Q()},get children(){return t(i,{w:"$full",overflowX:"auto",get children(){return t(z,{highlightOnHover:!0,dense:!0,css:{tableLayout:"auto",width:"100%"},get children(){return[t(A,{get children(){return t(m,{get children(){return[t(I,{get children(){return e("storages.common.mount_path")}}),t(I,{get children(){return e("storages.common.driver")}}),t(I,{get children(){return e("storages.common.order")}}),t(I,{css:{minWidth:"100px"},get children(){return e("storages.common.usage")}}),t(I,{get children(){return e("storages.common.status")}}),t(I,{get children(){return e("storages.common.remark")}}),t(I,{get children(){return e("global.operations")}})]}})}}),t(J,{get children(){return t(H,{get each(){return N()},children:e=>t(Z,{storage:e,refresh:c})})}})]}})}})}})]}})]}})})}}});
