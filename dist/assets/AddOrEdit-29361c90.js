import{b as f,d as _,cn as k,b5 as p,bm as o,y as e,aa as v,bS as F,S as m,aB as c,bM as i,bz as l,I as h,bT as S,K as D,aP as M,D as P,bn as g,n as T,aC as q,d1 as L,b7 as b,ah as U}from"./index-be65d0a3.js";import{a as E}from"./FolderTree-fccae14d.js";import{P as z}from"./PublicKeys-1a17942b.js";import"./index-96263e17.js";const B=r=>{const u=f();return e(i,{display:"inline-flex",flexDirection:"row",alignItems:"center",gap:"$2",rounded:"$md",shadow:"$md",p:"$2",w:"fit-content",get children(){return[e(l,{mb:"0",get children(){return u("users.permissions.".concat(r.name))}}),e(b,{get checked(){return r.can},onChange:()=>r.onChange(!r.can)})]}})},V=()=>{const r=f(),{params:u,back:w}=_(),{id:t}=u,[s,a]=k({id:0,username:"",password:"",base_path:"",role:0,permission:0,disabled:!1,sso_id:""}),[$,y]=p(()=>o.get("/admin/user/get?id=".concat(t)));t&&(async()=>{const n=await y();g(n,a)})();const[x,I]=p(()=>o.post("/admin/user/".concat(t?"update":"create"),s));return e(U,{get loading(){return $()},get children(){return e(v,{w:"$full",alignItems:"start",spacing:"$2",get children(){return[e(F,{get children(){return r("global.".concat(t?"edit":"add"))}}),e(m,{get when(){return!c.is_guest(s)},get children(){return[e(i,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(l,{for:"username",display:"flex",alignItems:"center",get children(){return r("users.username")}}),e(h,{id:"username",get value(){return s.username},onInput:n=>a("username",n.currentTarget.value)})]}}),e(i,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(l,{for:"password",display:"flex",alignItems:"center",get children(){return r("users.password")}}),e(h,{id:"password",type:"password",placeholder:"********",get value(){return s.password},onInput:n=>a("password",n.currentTarget.value)})]}})]}}),e(i,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(l,{for:"base_path",display:"flex",alignItems:"center",get children(){return r("users.base_path")}}),e(E,{id:"base_path",get value(){return s.base_path},onChange:n=>a("base_path",n),onlyFolder:!0})]}}),e(i,{w:"$full",required:!0,get children(){return[e(l,{display:"flex",alignItems:"center",get children(){return r("users.permission")}}),e(S,{w:"$full",wrap:"wrap",gap:"$2",get children(){return e(D,{each:M,children:(n,d)=>e(B,{name:n,get can(){return c.can(s,d())},onChange:C=>{C?a("permission",s.permission|=1<<d()):a("permission",s.permission&=~(1<<d()))}})})}})]}}),e(m,{get when(){return t&&!c.is_guest(s)},get children(){return e(z,{isMine:!1,get userId(){return parseInt(t)}})}}),e(P,{get loading(){return x()},onClick:async()=>{const n=await I();g(n,async()=>{T.success(r("global.save_success")),s.username===q().username&&g(await o.get("/me"),L),w()})},get children(){return r("global.".concat(t?"save":"add"))}}),e(i,{w:"fit-content",display:"flex",get children(){return e(b,{css:{whiteSpace:"nowrap"},id:"disabled",onChange:n=>a("disabled",n.currentTarget.checked),color:"$neutral10",fontSize:"$sm",get checked(){return s.disabled},get children(){return r("users.disabled")}})}})]}})}})};export{V as default};
