System.register(["./index-legacy-BDeHuhEG.js","./icon-legacy-DU2Om5no.js","./video_box-legacy-BR6hIhzR.js","./hls-legacy-KngnNHQI.js","./index-legacy-ChPSMcE2.js","./Layout-legacy-CX9S_jCa.js","./index-legacy-BSmJRROv.js","./FolderTree-legacy-BIJpVzYm.js","./index-legacy-Co_p50m6.js","./index-legacy-BeAMvlve.js","./share-legacy-D_jYX2DT.js","./index-legacy-YXeQpXk-.js"],function(e,t){"use strict";var i,n,l,s,a,o,r,u,c,d,h,p,g,m,y,f,w,b,v,_,k,x,j,O,S,C,F,L,z,I,T,q,A,N,E,P;return{setters:[e=>{i=e.k,n=e.ak,l=e.e7,s=e.a9,a=e.e8,o=e.aB,r=e.cY,u=e.aN,c=e.bu,d=e.b0,h=e.dt,p=e.dv,g=e.bd,m=e.bv,y=e._,f=e.at,w=e.O,b=e.C,v=e.E,_=e.am,k=e.S,x=e.aO,j=e.ap,O=e.by,S=e.x,C=e.A,F=e.e9},e=>{L=e.O,z=e.A},e=>{I=e.A,T=e.V,q=e.e},e=>{A=e.a,N=e.e,E=e.H},e=>{P=e.q},null,null,null,null,null,null,null],execute:function(){var t=u("<span style=max-width:200px;text-overflow:ellipsis;word-break:break-all;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:12px>");e("default",()=>{const{pathname:e,searchParams:u}=i(),{proxyLink:H}=n(),V=l();let W=s.objs.filter(e=>e.type===L.VIDEO);0===W.length&&(W=[s.obj]);let B,D={id:e(),container:"#video-player",title:s.obj.name,volume:.5,autoplay:j("video_autoplay"),autoSize:!1,autoMini:!0,controls:[],loop:!1,flip:!0,playbackRate:!0,aspectRatio:!0,setting:!0,hotkey:!0,pip:!0,mutex:!0,fullscreen:!0,fullscreenWeb:!1,subtitleOffset:!0,miniProgressBar:!1,playsInline:!0,theme:o(),quality:[],plugins:[I],whitelist:[],screenshot:!0,settings:[],moreVideoAttr:{"webkit-playsinline":!0,playsInline:!0,crossOrigin:"anonymous"},type:"m3u8",customType:{m3u8:function(e,t){const i=new E;i.loadSource(t),i.attachMedia(e),e.src||(e.src=t)}},lang:["en","zh-cn","zh-tw"].includes(a().toLowerCase())?a().toLowerCase():"en",lock:!0,fastForward:!0,autoPlayback:!0,autoOrientation:!0,airplay:!0};const M=s.related.filter(e=>{for(const t of[".srt",".ass",".vtt"])if(e.name.endsWith(t))return!0;return!1}),R=s.related.find(e=>{for(const t of[".xml"])if(e.name.endsWith(t))return!0;return!1});if(0!=M.length){let e=function(e){"ass"==(i?"ass":"webvtt")?(B.subtitle.show=!1,B.emit("artplayer-plugin-ass:visible",e)):(B.subtitle.show=e,B.emit("artplayer-plugin-ass:visible",!1))},i=!1;const n=M[0];"ass"===r(n.name).toLowerCase()?(i=!0,D.plugins?.push(A({subUrl:H(n,!0)}))):D.subtitle={url:H(n,!0),type:r(n.name)};const l=[{id:"setting_subtitle_display",html:"Display",tooltip:"Show",switch:!0,onSwitch:function(t){t.tooltip=t.switch?"Hide":"Show",e(!t.switch);const i=D.settings?.find(e=>"setting_subtitle"===e.id);return i&&(i.tooltip=t.tooltip),!t.switch}}];M.forEach((e,i)=>{var n;l.push({default:0===i,html:(n=t(),c(n,"overflow","hidden"),c(n,"display","-webkit-box"),d(n,()=>e.name),h(()=>p(n,"title",e.name)),n),name:e.name,url:H(e,!0)})}),D.settings?.push({id:"setting_subtitle",html:"Subtitle",tooltip:"Show",icon:z({size:24}),selector:l,onSelect:function(t){"ass"===r(t.name).toLowerCase()?(i=!0,this.emit("artplayer-plugin-ass:switch",t.url),e(!0)):(i=!1,this.subtitle.switch(t.url,{name:t.name}),this.once("subtitleLoad",e.bind(this,!0)));const n=l.find(e=>"setting_subtitle_display"===e.id);return n&&!n.switch&&n.$html?.click?.(),n?.tooltip}})}R&&D.plugins?.push(N({danmuku:H(R,!0),speed:5,opacity:1,fontSize:25,color:"#FFFFFF",mode:0,margin:[0,"0%"],antiOverlap:!1,synchronousPlayback:!1,lockTime:5,maxLength:100,theme:"dark"}));const[U,$]=g(()=>m.post("/fs/other",{path:e(),password:y(),method:"video_preview"}));let Y,G;async function J(){const e=await $();O(e,async e=>{const t=e.video_preview_play_info.live_transcoding_task_list.filter(e=>e.url);if(0===t.length)return void S.error("No transcoding video found");const i=t.map((e,i)=>({html:e.template_id,url:e.url,default:i===t.length-1}));D.quality=i,B.quality=i,G=B.currentTime;let n=B.playing;await B.switchUrl(i[i.length-1].url),n||B.pause(),setTimeout(()=>{B.seek=G},1e3)})}f(async()=>{const e=await $();Z(200!==e.code),O(e,e=>{const t=e.video_preview_play_info.live_transcoding_task_list.filter(e=>e.url);if(0===t.length)return void S.error("No transcoding video found");let i;switch(D.url=t[t.length-1].url,D.quality=t.map((e,i)=>({html:e.template_id,url:e.url,default:i===t.length-1})),B=new q(D),u.auto_fullscreen){case"true":i=!0;case"false":i=!1;default:i=!1}B.on("ready",()=>{B.fullscreen=i}),B.on("video:ended",()=>{K()&&(()=>{const e=W.findIndex(e=>e.name===s.obj.name);e<W.length-1&&V(C(F(location.pathname),W[e+1].name)+"?auto_fullscreen="+B.fullscreen)})()}),Y=window.setInterval(J,84e4)}),B.on("error",()=>{B.video.crossOrigin&&(console.log("Error detected. Trying to remove Cross-Origin attribute. Screenshot may not be available."),B.video.crossOrigin=null)})}),w(()=>{B?.destroy(),window.clearInterval(Y)});const[K,Q]=b(),[X,Z]=b(!1);return v(T,{onAutoNextChange:Q,get children(){return[v(_,{w:"$full",h:"60vh",id:"video-player"}),v(k,{get when(){return X()},get children(){return v(x,{w:"100%",h:"60vh",bgColor:"black",get children(){return v(P,{size:"4rem"})}})}})]}})})}}});
